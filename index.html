<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Feuerwehr Rust ‚Äì Ausbildungsplattform</title>
<style>
body{margin:0;font-family:system-ui;background:#0b1d16;color:#eaf6f0}
.wrap{max-width:1100px;margin:auto;padding:16px}
h1,h2,h3{margin:.4em 0}
.card{background:#132b22;border-radius:14px;padding:16px;margin-bottom:14px}
button{padding:12px;border-radius:10px;border:0;background:#35d07f;font-weight:700;width:100%;margin-top:8px}
button.secondary{background:#445}
select,input{width:100%;padding:12px;border-radius:10px;border:0;margin-top:6px}
.small{opacity:.8;font-size:13px}
.hidden{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px}
.badge{background:#264;border-radius:6px;padding:2px 6px;font-size:12px}
</style>
</head>
<body>
<div class="wrap">
<h1>üöí Feuerwehr Rust ‚Äì Ausbildungsplattform</h1>
<p class="small">Interner Ausbildungsnachweis ¬∑ lokal ¬∑ ohne Daten√ºbertragung</p>

<div class="card" id="roleView">
<h2>Rolle ausw√§hlen</h2>
<select id="roleSel">
<option value="">Bitte w√§hlen‚Ä¶</option>
<option value="TM">Truppmann</option>
<option value="TF">Truppf√ºhrer</option>
<option value="GF">Gruppenf√ºhrer</option>
<option value="MA">Maschinist</option>
<option value="ZF">Zugf√ºhrer</option>
<option value="EL">Einsatzleitung</option>
</select>
<button onclick="setRole()">Weiter</button>
</div>

<div class="card hidden" id="homeView">
<h2 id="homeTitle"></h2>
<div class="grid" id="modules"></div>
<p class="small" id="stats"></p>
<button class="secondary" onclick="resetAll()">üîÑ Alles zur√ºcksetzen</button>
</div>

<div class="card hidden" id="modeView">
<h3 id="modeTitle"></h3>
<label><input type="radio" name="mode" value="learn" checked> Lernmodus (mit Erkl√§rung)</label><br>
<label><input type="radio" name="mode" value="exam"> Pr√ºfungsmodus</label>
<button onclick="startQuiz()">Starten</button>
</div>

<div class="card hidden" id="quizView">
<h3 id="quizTitle"></h3>
<p id="qText"></p>
<div id="answers"></div>
<button onclick="nextQ()">Weiter</button>
<button class="secondary" onclick="restartQuiz()">üîÅ Quiz neu starten</button>
</div>

<div class="card hidden" id="resultView">
<h2>Ergebnis</h2>
<p id="resText"></p>
<input id="nameInput" placeholder="Name f√ºr Zertifikat">
<button onclick="makeCert()">Zertifikat erzeugen</button>
<canvas id="cert" width="1000" height="700" class="hidden"></canvas>
<button class="secondary" onclick="toHome()">Zur√ºck zur Startseite</button>
</div>
</div>

<script>
// === Module & Fragen (gek√ºrzt, fachlich korrekt, erweiterbar) ===
const MODULES={
 GF:[{id:"gf_brand",t:"Einsatztaktik Brandeinsatz"}],
 TM:[{id:"as_tm",t:"Atemschutz Truppmann"}],
 TF:[{id:"as_tf",t:"Atemschutz Truppf√ºhrer"}],
 MA:[{id:"ma",t:"Maschinist L√∂schfahrzeuge"}],
 ZF:[{id:"zf",t:"Zugf√ºhrer ‚Äì F√ºhrung im Einsatz"}],
 EL:[{id:"el",t:"Einsatzleitung ‚Äì Grundlagen"}]
};

const Q={
 gf_brand:[
  {q:"Was ist die erste Aufgabe des Gruppenf√ºhrers?",a:["Befehl","Erkundung","Angriff","Wasser"],c:1,e:"FwDV 3: Erst Erkundung, dann Befehl."},
  {q:"Wann Einsatz mit Bereitstellung?",a:["Immer","Bei unklarer Lage","Nie","Bei TH"],c:1,e:"FwDV 3."}
 ],
 as_tm:[
  {q:"Atemschutz bei‚Ä¶",a:["Sauerstoffmangel","Hitze","Licht","L√§rm"],c:0,e:"FwDV 7."}
 ],
 as_tf:[
  {q:"R√ºckzug wenn‚Ä¶",a:["Zeit","Restdruck","Lust","Befehl"],c:1,e:"Sicherheitsregel."}
 ],
 ma:[
  {q:"Pumpe l√§uft‚Ä¶",a:["sofort","auf Befehl","nie","bei Bedarf"],c:1,e:"FwDV 3."}
 ],
 zf:[
  {q:"ZF f√ºhrt‚Ä¶",a:["Trupp","Zug","Staffel","Gruppe"],c:1,e:"FwDV 100."}
 ],
 el:[
  {q:"Grundlage der Einsatzleitung?",a:["Lage","Gef√ºhl","Funk","Plan"],c:0,e:"FwDV 100."}
 ]
};

let role,mod,quiz,idx,score,mode;

function setRole(){
 role=roleSel.value;if(!role)return;
 roleView.classList.add("hidden");
 homeView.classList.remove("hidden");
 homeTitle.textContent="Rolle: "+role;
 renderModules(); renderStats();
}

function renderModules(){
 modules.innerHTML="";
 (MODULES[role]||[]).forEach(m=>{
  let b=document.createElement("button");
  b.innerHTML=m.t+" <span class='badge'>"+role+"</span>";
  b.onclick=()=>{mod=m;homeView.classList.add("hidden");modeView.classList.remove("hidden");modeTitle.textContent=m.t;}
  modules.appendChild(b);
 });
}

function startQuiz(){
 mode=document.querySelector("input[name=mode]:checked").value;
 quiz=[...(Q[mod.id]||[])]; idx=0; score=0;
 modeView.classList.add("hidden"); quizView.classList.remove("hidden"); renderQ();
}

function renderQ(){
 quizTitle.textContent=mod.t+" ("+(idx+1)+"/"+quiz.length+")";
 qText.textContent=quiz[idx].q;
 answers.innerHTML="";
 quiz[idx].a.forEach((t,i)=>{
  let b=document.createElement("button");b.textContent=t;
  b.onclick=()=>answer(i); answers.appendChild(b);
 });
}

function answer(i){
 if(i===quiz[idx].c) score++;
 if(mode==="learn") alert("Erkl√§rung: "+quiz[idx].e);
 nextQ();
}

function nextQ(){
 idx++;
 if(idx>=quiz.length){
  quizView.classList.add("hidden"); resultView.classList.remove("hidden");
  let pct=Math.round(score/quiz.length*100);
  resText.textContent="Ergebnis: "+pct+" % "+(pct>=80?"‚Äì bestanden":"‚Äì nicht bestanden");
  saveStats(mod.id,pct);
 } else renderQ();
}

function restartQuiz(){ if(confirm("Quiz neu starten?")){idx=0;score=0;renderQ();} }

function saveStats(id,p){
 let s=JSON.parse(localStorage.fwstats||"{}");
 s[id]=s[id]||{v:0,b:0}; s[id].v++; s[id].b=Math.max(s[id].b,p);
 localStorage.fwstats=JSON.stringify(s);
}

function renderStats(){
 let s=JSON.parse(localStorage.fwstats||"{}"),t="";
 for(let k in s) t+=k+": "+s[k].b+"% ¬∑ ";
 stats.textContent="Statistik: "+t;
}

function makeCert(){
 let n=nameInput.value||"";
 let c=cert; c.classList.remove("hidden");
 let x=c.getContext("2d");
 x.fillStyle="#fff";x.fillRect(0,0,c.width,c.height);
 x.fillStyle="#000";x.font="40px sans-serif";
 x.fillText("Interner Ausbildungsnachweis",260,120);
 x.font="24px sans-serif";
 x.fillText("Feuerwehr Rust",380,170);
 x.fillText("Name: "+n,140,270);
 x.fillText("Rolle: "+role,140,320);
 x.fillText("Modul: "+mod.t,140,370);
 x.fillText("Datum: "+new Date().toLocaleString(),140,420);
}

function toHome(){ resultView.classList.add("hidden"); homeView.classList.remove("hidden"); renderStats(); }
function resetAll(){ if(confirm("Alles l√∂schen?")){localStorage.clear();location.reload();} }
</script>
</body>
</html>